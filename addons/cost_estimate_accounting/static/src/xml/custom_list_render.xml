<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="cost_estimate_accounting.ListRenderer" t-inherit="web.ListRenderer" t-inherit-mode="extension" owl="1">
        <xpath expr="//table" position="before">
            <t t-if="props.list.resModel === 'cost.estimate.accounting'">
                <!-- Set currency symbol -->
                <t t-set="currencySymbol" t-value="props.list.records.length &gt; 0 ? (props.list.records[0].data.currency_id ? props.list.records[0].data.currency_id[1] : '') : ''"/>

                <!-- Dashboard container -->
                <div class="o_accounting_dashboard_container d-flex gap-3 mb-2">

                    <!-- Tổng số dự toán -->
                    <div class="o_dashboard_card border p-3 rounded text-center flex-fill bg-light">
                        <span class="h4 text-primary" t-esc="props.list.records.length"/>
                        <div>Tổng số dự toán</div>
                    </div>

                    <!-- Dự toán cao nhất -->
                    <t t-set="topRecord" t-value="props.list.records.reduce((max, r) =&gt; (r.data.total_cost || 0) &gt; (max.data.total_cost || 0) ? r : max, props.list.records[0])"/>
                    <div class="o_dashboard_card border p-3 rounded text-center flex-fill bg-light">
                        <span class="h5 text-success">
                            <t t-esc="topRecord.data.name || 'Không có'"/>
 |
                            <t t-esc="(topRecord.data.total_cost || 0).toLocaleString()"/>
                            <t t-esc="currencySymbol"/>
                        </span>
                        <div>Dự toán cao nhất</div>
                    </div>

                    <!-- Tổng chi phí -->
                    <t t-set="totalCost" t-value="props.list.records.reduce((sum, r) =&gt; sum + (r.data.total_cost || 0), 0)"/>
                    <div class="o_dashboard_card border p-3 rounded text-center flex-fill bg-light">
                        <span class="h4 text-danger">
                            <t t-esc="totalCost.toLocaleString()"/>
                            <t t-esc="currencySymbol"/>
                        </span>
                        <div>Tổng chi phí</div>
                    </div>

                </div>
            </t>
        </xpath>
    </t>
</templates>
